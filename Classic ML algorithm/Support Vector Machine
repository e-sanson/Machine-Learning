{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Support Vector Machine Classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Preliminaries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:38:12.456826Z",
     "start_time": "2018-04-06T10:38:12.427749Z"
    }
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "\n",
    "%matplotlib inline\n",
    "\n",
    "import sys\n",
    "sys.path.append(\"../..\")\n",
    "import E4525_ML.samples as samples\n",
    "\n",
    "\n",
    "from sklearn import svm\n",
    "from sklearn import model_selection\n",
    "from E4525_ML import plots"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 244,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:38:17.514269Z",
     "start_time": "2018-04-06T10:38:17.510258Z"
    }
   },
   "outputs": [],
   "source": [
    "seed=4543\n",
    "np.random.seed(seed)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-02T20:40:09.742907Z",
     "start_time": "2018-04-02T20:40:09.739907Z"
    }
   },
   "source": [
    "### Sample Data Generation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 245,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:38:19.251888Z",
     "start_time": "2018-04-06T10:38:19.245871Z"
    }
   },
   "outputs": [],
   "source": [
    "N=40\n",
    "X,Y=samples.ellipsoid(N//2)\n",
    "X_test,Y_test=samples.ellipsoid(N//2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 246,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:38:20.328748Z",
     "start_time": "2018-04-06T10:38:20.066050Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x1031610f0>"
      ]
     },
     "execution_count": 246,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(X[:,0],X[:,1],c=Y, s=40, cmap=plt.cm.Spectral)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Polinomial features"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-02T20:43:13.079907Z",
     "start_time": "2018-04-02T20:43:13.070907Z"
    }
   },
   "source": [
    "\n",
    "\n",
    "$$\n",
    "        X_1, X_2, X_1^2, X_1 X_2, X_2^2\n",
    "$$\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:14:49.648330Z",
     "start_time": "2018-04-03T09:14:49.643316Z"
    }
   },
   "outputs": [],
   "source": [
    "def phi(X):\n",
    "    X1=X[:,0]\n",
    "    X2=X[:,1]\n",
    "    return np.vstack((X1,X2,X1**2,X1*X2,X2**2)).T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 248,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:14:51.382939Z",
     "start_time": "2018-04-03T09:14:51.377928Z"
    }
   },
   "outputs": [],
   "source": [
    "Z=phi(X)\n",
    "Z_test=phi(X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Linear SVM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:14:54.983509Z",
     "start_time": "2018-04-03T09:14:54.958445Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8"
      ]
     },
     "execution_count": 249,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model=svm.SVC(C=1000000000,kernel=\"linear\") \n",
    "np.average(model_selection.cross_val_score(model,Z,Y,cv=10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 250,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:02.583707Z",
     "start_time": "2018-04-03T09:15:02.578693Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number of support vectors is 8\n"
     ]
    }
   ],
   "source": [
    "model.fit(Z,Y)\n",
    "print(f'The number of support vectors is {len(model.support_vectors_)}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:05.051266Z",
     "start_time": "2018-04-03T09:15:05.047255Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1000000000.0\n"
     ]
    }
   ],
   "source": [
    "print(max(model.dual_coef_[0]))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 10-fold cross validation - optimal value of C \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 252,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:11.521461Z",
     "start_time": "2018-04-03T09:15:11.518453Z"
    }
   },
   "outputs": [],
   "source": [
    "Cs=[0.001,0.01,0.1,1,10,100,1000,10000]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:11.874399Z",
     "start_time": "2018-04-03T09:15:11.871391Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 4.71747825  4.93114745 22.25460101 23.26258084 24.3162152 ]\n",
      " [-0.85688319  5.03507915  0.7342488  -4.31447467 25.35202202]\n",
      " [-0.76763744  4.96832361  0.58926724 -3.81387121 24.68423951]\n",
      " [-5.3422035  -2.15364523 28.53913824 11.5052111   4.63818779]\n",
      " [ 2.1758714  -4.18493477  4.73441636 -9.10587988 17.51367899]\n",
      " [ 4.46813644 -1.04616339 19.96424323 -4.67440075  1.09445783]\n",
      " [ 3.4780773   5.11548949 12.09702169 17.79206787 26.16823275]\n",
      " [-0.65807057  5.09593951  0.43305688 -3.35348784 25.96859946]\n",
      " [-4.84612403 -2.10143256 23.48491814 10.18380284  4.41601881]]\n",
      "0.1\n"
     ]
    }
   ],
   "source": [
    "model=svm.SVC(kernel=\"linear\") \n",
    "\n",
    "parameters = {'C':Cs}\n",
    "clf=model_selection.GridSearchCV(model,parameters,cv=10)\n",
    "clf.fit(Z,Y)\n",
    "best_model=clf.best_estimator_\n",
    "\n",
    "best_model.fit(Z,Y)\n",
    "support_vectors=best_model.support_vectors_\n",
    "print(support_vectors)\n",
    "\n",
    "dual_coef=best_model.dual_coef_[0]\n",
    "\n",
    "print(max(abs(dual_coef)))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 254,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:19.218917Z",
     "start_time": "2018-04-03T09:15:19.193852Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.95"
      ]
     },
     "execution_count": 254,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.average(model_selection.cross_val_score(best_model,Z, Y,cv=10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 255,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:28.030337Z",
     "start_time": "2018-04-03T09:15:28.024321Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The class Y for each support vector is [0 0 0 0 0 1 1 1 1]\n"
     ]
    }
   ],
   "source": [
    "best_model.fit(Z,Y)\n",
    "support_vectors_classes=Y[best_model.support_]\n",
    "print(f'The class Y for each support vector is {support_vectors_classes}')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:09:41.669967Z",
     "start_time": "2018-04-03T10:09:41.663950Z"
    }
   },
   "source": [
    "\n",
    "$$\n",
    "    \\sum_i \\alpha_i y_i =0\n",
    "$$\n",
    "where $y_i=-1$ for the negative class and $y_i=+1$ for the positive class\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 256,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:32.466124Z",
     "start_time": "2018-04-03T09:15:32.455095Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-2.7755575615628914e-17"
      ]
     },
     "execution_count": 256,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "support_coef=best_model.dual_coef_[0].ravel()\n",
    "support_coef.sum()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 257,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:34.758215Z",
     "start_time": "2018-04-03T09:15:34.752200Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2, 6, 7, 8]\n",
      "[[-0.76763744  4.96832361  0.58926724 -3.81387121 24.68423951]\n",
      " [ 3.4780773   5.11548949 12.09702169 17.79206787 26.16823275]\n",
      " [-0.65807057  5.09593951  0.43305688 -3.35348784 25.96859946]\n",
      " [-4.84612403 -2.10143256 23.48491814 10.18380284  4.41601881]]\n"
     ]
    }
   ],
   "source": [
    "C=0.1\n",
    "index=[]\n",
    "\n",
    "for i in range (0,len(support_coef)):\n",
    "    if abs(support_coef[i])==C:\n",
    "        index.append(i)\n",
    "print(index)\n",
    "\n",
    "print(support_vectors[index])\n",
    "        "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:18:52.672521Z",
     "start_time": "2018-04-03T10:18:52.666505Z"
    }
   },
   "source": [
    "## Vector of loadings $w$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 258,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:39.007508Z",
     "start_time": "2018-04-03T09:15:39.001493Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.14682956  0.06861315 -0.37866999  0.25213885 -0.37136477]\n",
      "[ 0.14682956  0.06861315 -0.37866999  0.25213885 -0.37136477]\n"
     ]
    }
   ],
   "source": [
    "#check with the built-in function \n",
    "w=best_model.coef_[0]\n",
    "print(w)\n",
    "\n",
    "W=support_coef[:,np.newaxis]*support_vectors\n",
    "W=W.sum(axis=0)\n",
    "\n",
    "print(W)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:20:51.574518Z",
     "start_time": "2018-04-03T10:20:51.568503Z"
    }
   },
   "source": [
    "## We compute $b$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 259,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:43.510475Z",
     "start_time": "2018-04-03T09:15:43.505462Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "9.56072019709151\n",
      "True\n",
      "9.560927983540612\n"
     ]
    }
   ],
   "source": [
    "# check with the built-in function \n",
    "\n",
    "b=best_model.intercept_[0]\n",
    "print(b)\n",
    "if 0 not in index:\n",
    "    print('True')\n",
    "    \n",
    "Y0=support_coef[0]/abs(support_coef[0])\n",
    "\n",
    "\n",
    "b= - np.dot(w.T,support_vectors[0]) +1/Y0\n",
    "\n",
    "print(b)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 260,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(5,)\n",
      "(40, 5)\n"
     ]
    }
   ],
   "source": [
    "print(w.shape)\n",
    "print(Z.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 261,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:15:57.863622Z",
     "start_time": "2018-04-03T09:15:57.859611Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.975\n",
      "0.975\n",
      "The accuracy of your function is the same as the accuracy of the predict method of the best estimator\n"
     ]
    }
   ],
   "source": [
    "def prediction (Z,w,b):\n",
    "    Y=np.zeros(len(Z))\n",
    "    for i in range (0,len(Z)):\n",
    "        Y[i]=np.dot(w.T,Z[i,:])+b\n",
    "    Y=(np.sign(Y)+1)/2\n",
    "    return Y\n",
    "\n",
    "Y_pred_1=prediction (Z,w,b)\n",
    "print(np.average(Y_pred_1==Y))\n",
    " \n",
    "Y_pred=best_model.predict(Z)\n",
    "print(np.average(Y_pred==Y))\n",
    "\n",
    "if np.average(Y_pred_1==Y)==np.average(Y_pred==Y):\n",
    "    print('The accuracy of your function is the same as the accuracy of the predict method of the best estimator')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Polinomial Kernel"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Polinomial kernel:\n",
    "$$\n",
    "    K(x,x') = (1 + x^T x')^2\n",
    "$$\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 262,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:41:21.745872Z",
     "start_time": "2018-04-03T10:41:21.742864Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9"
      ]
     },
     "execution_count": 262,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "poly_model=svm.SVC(C=1000000000,kernel=\"poly\",degree=2,gamma=1,coef0=1)\n",
    "np.average(model_selection.cross_val_score(poly_model,X,Y,cv=10))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:34:28.640987Z",
     "start_time": "2018-04-03T10:34:28.630960Z"
    }
   },
   "source": [
    "10-fold cross validation - optimal values of $C$ and $\\gamma$ to use while fitting a  SVC polynomial kernel with the untransformed training data `X`. Keep the constant $c$ (`coef0`) fixed at 1.\n",
    "\n",
    "Display clearly the optimal values of $C$ and $\\gamma$, and the number of support vectors of the best model\n",
    "\n",
    "[HINT] \n",
    "\n",
    "1. Read the  [`model_selection.GridSearchCV` ](http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV)        documentation carefully\n",
    "2. Parameters to search over are passed in the `parameters`'s  **dictionary**   argument of `GridSearchCV`\n",
    "3. The number of folds is controled by the argument  `cv`\n",
    "4. Consider only the values of $C$ and $\\gamma$ provided below\n",
    "5. The GridSearchCV object, after fitting, contains a variable **`best_estimator_`** with the best calibrated model. You can get \n",
    "   from the values of best estimator's $C$  and $\\gamma$ parameters and the array of support vectors.\n",
    "6. As the search may be a bit time consuming, it may be useful so set the `GridSearchCV` verbose parameter so that you can see if the search is making progress."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 263,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:41:24.351797Z",
     "start_time": "2018-04-03T10:41:24.347788Z"
    }
   },
   "outputs": [],
   "source": [
    "Cs=[0.001,0.01,0.1,1,10,100]\n",
    "gammas=[0.01,0.1,1,10,100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 264,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T10:41:25.340425Z",
     "start_time": "2018-04-03T10:41:25.337417Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "32 [[ 4.5580055  -2.20267639]\n",
      " [ 6.16510186  2.23039578]\n",
      " [ 4.71747825  4.93114745]\n",
      " [ 5.10518255  4.54402952]\n",
      " [ 3.62216133  5.8396358 ]\n",
      " [-0.66254926  5.85047639]\n",
      " [-0.85688319  5.03507915]\n",
      " [-0.76763744  4.96832361]\n",
      " [-4.37374094  2.05802205]\n",
      " [-5.81048568 -1.13915865]\n",
      " [-5.3422035  -2.15364523]\n",
      " [-3.67927333 -5.03515141]\n",
      " [-5.6712814  -4.43350214]\n",
      " [ 0.68678119 -6.16216673]\n",
      " [ 4.09448442 -3.11332949]\n",
      " [ 2.1758714  -4.18493477]\n",
      " [ 4.46813644 -1.04616339]\n",
      " [ 3.82734945  2.11959121]\n",
      " [ 4.36494726  2.24028098]\n",
      " [ 4.97610384  3.37897384]\n",
      " [ 3.4780773   5.11548949]\n",
      " [-0.36009911  3.61832315]\n",
      " [-0.65807057  5.09593951]\n",
      " [-3.12192323  1.63754771]\n",
      " [-3.72790519 -1.31951232]\n",
      " [-3.81196873 -1.47706162]\n",
      " [-3.48451533 -3.95952945]\n",
      " [-4.84612403 -2.10143256]\n",
      " [-2.94162577 -4.32396285]\n",
      " [-0.12372473 -4.4791839 ]\n",
      " [-0.79576065 -4.4059671 ]\n",
      " [ 3.47275917 -1.2114773 ]]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "SVC(C=10, cache_size=200, class_weight=None, coef0=1,\n",
       "    decision_function_shape='ovr', degree=2, gamma=0.01, kernel='poly',\n",
       "    max_iter=-1, probability=False, random_state=None, shrinking=True,\n",
       "    tol=0.001, verbose=False)"
      ]
     },
     "execution_count": 264,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model=svm.SVC(kernel=\"poly\",degree=2,coef0=1)\n",
    "parameters = {'C':Cs,'gamma':gammas}\n",
    "clf=model_selection.GridSearchCV(model,parameters,cv=10)\n",
    "clf.fit(Z,Y)\n",
    "best_poly_model=clf.best_estimator_\n",
    "\n",
    "best_poly_model.fit(X,Y)\n",
    "support_vectors=best_poly_model.support_vectors_\n",
    "print(len(support_vectors),support_vectors)\n",
    "\n",
    "best_poly_model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:12.901242Z",
     "start_time": "2018-04-03T09:19:12.862139Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.3 </div>\n",
    "Show the class Y for each support vector\n",
    "\n",
    "[HINT] after fitting the estimator  contains an boolean array `support_` that is set true for the index of data points that are support vectors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 265,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:12.928316Z",
     "start_time": "2018-04-03T09:19:12.907258Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,\n",
       "       1, 1, 1, 1, 1, 1, 1, 1, 1, 1], dtype=uint8)"
      ]
     },
     "execution_count": 265,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "support_vectors_index=best_poly_model.support_\n",
    "Y[support_vectors_index]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:46:04.857000Z",
     "start_time": "2018-04-06T10:46:04.850985Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.4 </div>\n",
    "Show that\n",
    "$$\n",
    "    \\sum_i \\alpha_i y_i =0\n",
    "$$\n",
    "where $y_i=-1$ for the negative class and $y_i=+1$ for the positive class\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 266,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:12.979450Z",
     "start_time": "2018-04-03T09:19:12.951375Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "32\n"
     ]
    }
   ],
   "source": [
    "support_coef=best_poly_model.dual_coef_[0].ravel()\n",
    "support_coef.sum()\n",
    "print(len(support_coef))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-06T10:46:50.498374Z",
     "start_time": "2018-04-06T10:46:50.491356Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.5 </div>\n",
    "Show which support vectors are in violation of the margin\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 267,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:13.047634Z",
     "start_time": "2018-04-03T09:19:13.016550Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30]\n",
      "[[ 4.5580055  -2.20267639]\n",
      " [ 6.16510186  2.23039578]\n",
      " [ 4.71747825  4.93114745]\n",
      " [ 5.10518255  4.54402952]\n",
      " [-0.85688319  5.03507915]\n",
      " [-0.76763744  4.96832361]\n",
      " [-4.37374094  2.05802205]\n",
      " [-5.81048568 -1.13915865]\n",
      " [-5.3422035  -2.15364523]\n",
      " [-3.67927333 -5.03515141]\n",
      " [ 0.68678119 -6.16216673]\n",
      " [ 4.09448442 -3.11332949]\n",
      " [ 2.1758714  -4.18493477]\n",
      " [ 4.46813644 -1.04616339]\n",
      " [ 3.82734945  2.11959121]\n",
      " [ 4.36494726  2.24028098]\n",
      " [ 4.97610384  3.37897384]\n",
      " [ 3.4780773   5.11548949]\n",
      " [-0.36009911  3.61832315]\n",
      " [-0.65807057  5.09593951]\n",
      " [-3.12192323  1.63754771]\n",
      " [-3.81196873 -1.47706162]\n",
      " [-3.48451533 -3.95952945]\n",
      " [-4.84612403 -2.10143256]\n",
      " [-2.94162577 -4.32396285]\n",
      " [-0.12372473 -4.4791839 ]\n",
      " [-0.79576065 -4.4059671 ]]\n"
     ]
    }
   ],
   "source": [
    "index=[]\n",
    "\n",
    "for i in range (0,len(support_coef)):\n",
    "    if abs(support_coef[i])==10:\n",
    "        index.append(i)\n",
    "print(index)\n",
    "support_vectors_violation=support_vectors[index]\n",
    "print(support_vectors_violation)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:13.070693Z",
     "start_time": "2018-04-03T09:19:13.051643Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.6 </div>\n",
    "Write a function that, give two matrices $X_{i,d}$, $X'_{j,d}$ for $i=1,\\dots,N_1$, $j=1,\\dots,N_2$ and $d=1,\\dots D$\n",
    "computes the kernel products\n",
    "$$\n",
    "    K_{i,j} = \\textrm{kernel}(X_i,X'_j)\n",
    "$$\n",
    "where 'kernel' is the optimal kernel you found by cross-validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 268,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:13.090746Z",
     "start_time": "2018-04-03T09:19:13.076708Z"
    }
   },
   "outputs": [],
   "source": [
    "gamma=0.01\n",
    "def Kernel(X1,X2,gamma):\n",
    "    return (1 + gamma*np.dot(X1.T,X2))**2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:13.401572Z",
     "start_time": "2018-04-03T09:19:13.092751Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.7 </div>\n",
    "Write a prediction function that classifies points as having class $y=0$ or $y=1$ in terms of $\\alpha$, $b$, and the support vectors, using equation\n",
    "\n",
    "$$\n",
    "  y(x) =  \\frac{\\textrm{sign}( \\sum_i \\alpha_i y_i K(x,x_i) + b ) + 1}{2}\n",
    "$$\n",
    "\n",
    "Use this class to classify all points in the training set and verify that the accuracy of your function is exactly the same as  the\n",
    "accuracy of the `predict` method of the best estimator."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 269,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T09:19:13.409593Z",
     "start_time": "2018-04-03T09:19:13.403577Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.9\n",
      "0.9\n",
      "The accuracy of your function is the same as the accuracy of the predict method of the best estimator\n"
     ]
    }
   ],
   "source": [
    "b=best_poly_model.intercept_[0]\n",
    "\n",
    "gamma=0.01\n",
    "def prediction (X,gamma):\n",
    "    Y=np.zeros(len(X))\n",
    "    for i in range (0,len(X)):\n",
    "        for j in range (0,len(support_vectors)):\n",
    "            Y[i]+=support_coef[j]*Kernel(X[i],support_vectors[j],gamma)\n",
    "        Y[i]=(np.sign(Y[i]+b)+1)/2\n",
    "    return Y\n",
    "\n",
    "Y_pred_1=prediction (X,gamma)\n",
    "print(np.average(Y_pred_1==Y))\n",
    "\n",
    "Y_pred=best_poly_model.predict(X)\n",
    "print(np.average(Y_pred==Y))\n",
    "\n",
    "if np.average(Y_pred_1==Y)==np.average(Y_pred==Y):\n",
    "    print('The accuracy of your function is the same as the accuracy of the predict method of the best estimator')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T11:30:39.093828Z",
     "start_time": "2018-04-03T11:30:39.090820Z"
    }
   },
   "source": [
    "<div class=\"alert alert-block alert-info\"> Problem 3.8 </div>\n",
    "Use the function `decision_boundary_2d` from the python module `E4525_ML.plots` to display a graph of the training points and \n",
    "the optimal estimator descision boundary."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 270,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2018-04-03T11:30:39.932057Z",
     "start_time": "2018-04-03T11:30:39.909998Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAlIAAAEvCAYAAACOiy/xAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAgAElEQVR4nO3deXzU1b3/8deZmewLCWsCBgIGEFBkFUHBDVRc8Lq01d5WitdyW6s/W9vaVm+9vVhtpXaxi1q0tba1iy1abV2JG1UhIMiiLBIkyJYQSCArSWbm/P5IAgNknSXfycz7+Xj4MGG+850PwzfJO+ec7+cYay0iIiIi0n0upwsQERER6a0UpERERESCpCAlIiIiEiQFKREREZEgKUiJiIiIBElBSkRERCRIHideNDspxQ5Oy3TipUVERES6ZVPl/gPW2gFtPeZIkBqclsmf5tzgxEuLiIiIdMuEpx/a2d5jmtoTERERCZKClIiIiEiQFKREREREgqQgJSIiIhIkBSkRERGRIClIiYiIiAQpLEHKGPM1Y8yHxpgPjDF/NsYkh+O8IiIiItEs5CBljBkC/D9girX2dMANXB/qeUVERESiXbim9jxAijHGA6QCe8N0XhEREZGoFXKQstbuAR4EPgH2AYetta+Gel4RERGRaBeOqb1s4CpgODAYSDPGfK6N4xYaY94zxrxX2VAf6suKiIiIOC4cU3uzgR3W2nJrbRPwDDDjxIOstUustVOstVOyk1LC8LIiIiIizgpHkPoEONsYk2qMMcBFwOYwnFdEREQkqoVjjVQR8HdgLbCx5ZxLQj2viIiISLTzhOMk1tr/Bf43HOcSERER6S3U2VxEREQkSApSIiIiIkFSkBIREREJkoKUiIiISJAUpERERESCpCAlIiIiEiQFKREREZEgKUiJiIiIBElBSkRERCRIClIiIiIiQVKQEhEREQmSgpSIiIhIkBSkRERERIKkICUiIiISJAUpERERkSApSImIiIgESUFKREREJEgKUiIiIiJBUpASERERCZKClIiIiEiQFKREREREghSWIGWMyTLG/N0Ys8UYs9kYMz0c5xURERGJZp4wnech4GVr7XXGmEQgNUznFREREYlaIQcpY0wmMAv4AoC1thFoDPW8IiIiItEuHFN7I4By4AljzPvGmMeNMWlhOK+I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\n",
      "text/plain": [
       "<Figure size 720x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "f,ax= plt.subplots(1,1, sharey=True,figsize=(10,5))\n",
    "plots.decision_boundary_2d(best_poly_model,X,Y,ax,alpha=0.8,slack=0.25)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": true,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": "block",
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
